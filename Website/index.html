<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VCC Listing</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Geist:wght@400;500;600;700&family=Geist+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="page">
    <div class="frame">
      <header class="terminal-bar">
        <div class="terminal-left">
          <span class="terminal-user">guest@vpm</span>
          <span class="terminal-sep">:</span>
          <span class="terminal-path">~/</span>
          <span class="terminal-path accent">{{ listingInfo.Name }}</span>
        </div>
        <div class="terminal-right">
          <span class="status-pill">LIVE</span>
        </div>
      </header>

      <div class="frame-body">
        <header class="hero">
          <div class="hero-card{{ if listingInfo.BannerImage; ' has-media'; end; }}">
            {{~ if listingInfo.BannerImage; ~}}
              <div class="hero-media">
                <img class="hero-image" src="{{ listingInfo.BannerImageUrl }}" alt="{{ listingInfo.Name }} banner">
              </div>
            {{~ end; ~}}
            <div class="hero-content">
              <div class="eyebrow">VPM Package Listing</div>
              <h1>{{ listingInfo.Name }}</h1>
              {{~ if listingInfo.Description; ~}}
                <p class="lead">{{ listingInfo.Description }}</p>
              {{~ end; ~}}
              <div class="meta-row">
                <span class="meta-label">Published by</span>
                <a class="link" href="{{ listingInfo.Author.Url }}" target="_blank" rel="noopener">{{ listingInfo.Author.Name }}</a>
                {{~ if listingInfo.Author.Email; ~}}
                  <span class="meta-chip" title="{{ listingInfo.Author.Email }}">Email</span>
                {{~ end; ~}}
              </div>
              <div class="hero-actions">
                <button class="btn btn-primary js-add-to-vcc" id="vccAddRepoButton">Add to VCC</button>
                <button class="btn btn-ghost" id="urlBarHelp">How to add</button>
                {{~ if listingInfo.InfoLink.Url; ~}}
                  <a class="btn btn-outline" href="{{ listingInfo.InfoLink.Url }}" target="_blank" rel="noopener">
                    {{ if listingInfo.InfoLink.Text; listingInfo.InfoLink.Text; else; 'Learn more'; end; }}
                  </a>
                {{~ end; ~}}
              </div>
            </div>
          </div>
        </header>

        <section class="cta-card">
          <div class="cta-content">
            <div class="cta-header">
              <div class="eyebrow">Listing URL</div>
              <p class="muted">Use this URL in VCC to add the listing directly.</p>
            </div>
            <div class="field">
              <label for="vccUrlField">Listing URL</label>
              <div class="field-row">
                <input id="vccUrlField" class="input" type="text" readonly value="{{ listingInfo.Url }}" aria-readonly="true">
                <button class="btn btn-secondary" id="vccUrlFieldCopy">Copy</button>
              </div>
            </div>
          </div>
        </section>

        <section class="packages-section">
          <div class="section-header">
            <div>
              <h2>Packages</h2>
              <p class="muted">Browse the packages published to this listing.</p>
            </div>
            <div class="search field">
              <label for="searchInput">Search</label>
              <div class="field-row search-row">
                <span class="search-icon" aria-hidden="true">
                  <svg width="16" height="16" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12.9069 14.3206L16.2932 17.7069C16.6837 18.0974 17.3168 18.0974 17.7074 17.7069C18.0979 17.3164 18.0979 16.6832 17.7074 16.2927L14.3211 12.9064C15.1802 11.8707 15.7001 10.5428 15.7001 9.0919C15.7001 5.82828 13.0637 3.1919 9.8001 3.1919C6.53648 3.1919 3.9001 5.82828 3.9001 9.0919C3.9001 12.3555 6.53648 14.9919 9.8001 14.9919C11.251 14.9919 12.5789 14.472 13.6146 13.6129L12.9069 14.3206ZM5.3001 9.0919C5.3001 6.60209 7.31029 4.5919 9.8001 4.5919C12.2899 4.5919 14.3001 6.60209 14.3001 9.0919C14.3001 11.5817 12.2899 13.5919 9.8001 13.5919C7.31029 13.5919 5.3001 11.5817 5.3001 9.0919Z" />
                  </svg>
                </span>
                <input id="searchInput" class="input input-search" type="text" placeholder="Search packages..." autocomplete="off">
              </div>
            </div>
          </div>
          <div class="package-grid" id="packageGrid">
            {{~ for package in packages ~}}
              <div class="package-card" data-package-name="{{ if package.DisplayName; package.DisplayName; else; package.Name; end; }}" data-package-id="{{ package.Name }}">
                <div class="package-head">
                  <div class="package-thumb" data-name="{{ if package.DisplayName; package.DisplayName; else; package.Name; end; }}" data-image="{{ if package.ImageUrl; package.ImageUrl; else; if package.IconUrl; package.IconUrl; else; if package.ThumbnailUrl; package.ThumbnailUrl; else; ''; end; end; end; }}">
                    <span class="thumb-fallback">#</span>
                  </div>
                  <div class="package-meta">
                    <div class="package-title">{{ if package.DisplayName; package.DisplayName; else; package.Name; end; }}</div>
                    <div class="package-description">{{ if package.Description; package.Description; else; 'No description provided.'; end; }}</div>
                    <div class="package-id">{{ package.Name }}</div>
                  </div>
                </div>
                <div class="package-tags">
                  {{~ if package.Type; ~}}<span class="badge">{{ package.Type }}</span>{{~ end; ~}}
                  {{~ if package.Version; ~}}<span class="badge soft">v{{ package.Version }}</span>{{~ end; ~}}
                </div>
                <div class="package-actions">
                  <button class="btn btn-outline js-add-to-vcc">Add to VCC</button>
                  <button class="btn btn-ghost js-package-info" data-package-id="{{ package.Name }}">Details</button>
                  {{~ if package.ZipUrl; ~}}
                    <a class="btn btn-ghost" href="{{ package.ZipUrl }}" target="_blank" rel="noopener">Download</a>
                  {{~ end; ~}}
                </div>
              </div>
            {{~ end ~}}
          </div>
          <div class="empty-state" id="emptyState" hidden>
            <div class="empty-card">
              <div class="empty-title">No packages found</div>
              <div class="muted">Try a different search or clear the filter.</div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <dialog id="addListingToVccHelp" class="dialog">
    <div class="dialog-content">
      <div class="dialog-header">
        <div>
          <div class="eyebrow">Getting started</div>
          <h3>How to add this listing to your VCC</h3>
        </div>
        <button class="icon-button" data-dialog-close aria-label="Close dialog">
          <svg width="18" height="18" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M4.08859 4.21569L4.14645 4.14645C4.32001 3.97288 4.58944 3.9536 4.78431 4.08859L4.85355 4.14645L10 9.293L15.1464 4.14645C15.32 3.97288 15.5894 3.9536 15.7843 4.08859L15.8536 4.14645C16.0271 4.32001 16.0464 4.58944 15.9114 4.78431L15.8536 4.85355L10.707 10L15.8536 15.1464C16.0271 15.32 16.0464 15.5894 15.9114 15.7843L15.8536 15.8536C15.68 16.0271 15.4106 16.0464 15.2157 15.9114L15.1464 15.8536L10 10.707L4.85355 15.8536C4.67999 16.0271 4.41056 16.0464 4.21569 15.9114L4.14645 15.8536C3.97288 15.68 3.9536 15.4106 4.08859 15.2157L4.14645 15.1464L9.293 10L4.14645 4.85355C3.97288 4.67999 3.9536 4.41056 4.08859 4.21569Z" />
          </svg>
        </button>
      </div>
      <ol class="steps">
        <li>Open your VCC and go to Settings.</li>
        <li>Click the Packages tab.</li>
        <li>Click Add Repository.</li>
        <li>Paste the listing URL shown below.</li>
        <li>Click Add and confirm the prompt.</li>
      </ol>
      <div class="field">
        <label for="vccListingInfoUrlField">Listing URL</label>
        <div class="field-row">
          <input id="vccListingInfoUrlField" class="input" type="text" readonly value="{{ listingInfo.Url }}" aria-readonly="true">
          <button class="btn btn-secondary" id="vccListingInfoUrlFieldCopy">Copy</button>
        </div>
      </div>
      <p class="muted">
        Read more about package listings on the
        <a class="link" href="https://vcc.docs.vrchat.com" target="_blank" rel="noopener">VCC docs</a>.
      </p>
    </div>
  </dialog>

  <dialog id="packageInfoModal" class="dialog dialog-lg">
    <div class="dialog-content">
      <div class="dialog-header">
        <div>
          <div class="eyebrow">Package details</div>
          <h3 id="packageInfoName">Package Name</h3>
        </div>
        <button class="icon-button" data-dialog-close aria-label="Close dialog">
          <svg width="18" height="18" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M4.08859 4.21569L4.14645 4.14645C4.32001 3.97288 4.58944 3.9536 4.78431 4.08859L4.85355 4.14645L10 9.293L15.1464 4.14645C15.32 3.97288 15.5894 3.9536 15.7843 4.08859L15.8536 4.14645C16.0271 4.32001 16.0464 4.58944 15.9114 4.78431L15.8536 4.85355L10.707 10L15.8536 15.1464C16.0271 15.32 16.0464 15.5894 15.9114 15.7843L15.8536 15.8536C15.68 16.0271 15.4106 16.0464 15.2157 15.9114L15.1464 15.8536L10 10.707L4.85355 15.8536C4.67999 16.0271 4.41056 16.0464 4.21569 15.9114L4.14645 15.8536C3.97288 15.68 3.9536 15.4106 4.08859 15.2157L4.14645 15.1464L9.293 10L4.14645 4.85355C3.97288 4.67999 3.9536 4.41056 4.08859 4.21569Z" />
          </svg>
        </button>
      </div>
      <div class="package-info">
        <div class="package-info-hero">
          <div class="package-thumb large" id="packageInfoThumb" data-name="">
            <span class="thumb-fallback">#</span>
          </div>
          <div class="package-info-meta">
            <div class="meta-row">
              <span class="meta-chip" id="packageInfoId">com.package.id</span>
              <span class="badge soft" id="packageInfoVersion">v1.0.0</span>
              <span class="badge" id="packageInfoType">Type</span>
            </div>
            <p class="muted" id="packageInfoDescription">Package description</p>
          </div>
        </div>
        <div class="info-grid">
          <div class="info-block" id="packageInfoAuthorWrap">
            <h5>Author</h5>
            <a class="link" href="#" id="packageInfoAuthor" target="_blank" rel="noopener">Author</a>
          </div>
          <div class="info-block" id="packageInfoLicenseWrap">
            <h5>License</h5>
            <a class="link" href="#" id="packageInfoLicense" target="_blank" rel="noopener">License</a>
          </div>
          <div class="info-block" id="packageInfoKeywordsWrap">
            <h5>Keywords</h5>
            <div class="tag-row" id="packageInfoKeywords"></div>
          </div>
          <div class="info-block" id="packageInfoDependenciesWrap">
            <h5>Dependencies</h5>
            <ul class="list" id="packageInfoDependencies"></ul>
          </div>
        </div>
        <div class="field">
          <label for="packageInfoVccUrlField">Listing URL</label>
          <div class="field-row">
            <input id="packageInfoVccUrlField" class="input" type="text" readonly value="{{ listingInfo.Url }}" aria-readonly="true">
            <button class="btn btn-secondary" id="packageInfoVccUrlFieldCopy">Copy</button>
            <button class="btn btn-ghost" id="packageInfoListingHelp">How to add</button>
          </div>
        </div>
      </div>
    </div>
  </dialog>

  <script src="app.js"></script>
</body>
</html>
